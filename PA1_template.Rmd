---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

Load the data, assuming it has been unzipped into the current working directory:
```{r}
df <- read.csv("activity.csv")
```

Look at the structure of the data:
```{r}
str(df)
head(df)
tail(df)
```


Convert the dates and times:
```{r}
library(lubridate)
# times might be useful for imputing missing values
df$time <- sprintf("%04d", df$interval)
df$date_time <- paste(df$date, df$time, sep="-")
df$date_time <- ymd_hm(df$date_time)
df$date <- ymd(df$date)

```



## What is mean total number of steps taken per day?

Make a histogram of the total number of steps taken each day:
```{r}
library(plyr)
sdf <- ddply(df, c("date"), summarize, total = sum(steps, na.rm = TRUE))
hist(sdf$total, breaks=20, main = "Histogram of the total number of steps taken each day", xlab="Total number of steps taken each day")
```

Calculate the mean and median total number of steps per day:
```{r}
mean(sdf$total)
median(sdf$total)
```

## What is the average daily activity pattern?

Make a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis):

```{r}
tdf <- ddply(df, c("interval"), summarize, avg = mean(steps, na.rm = TRUE))
plot(tdf$interval, tdf$avg, type="l", xlab="5-minute interval", ylab="Average number of steps")
```

Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
# display the row, to compare against the plot (for sanity checking)
tdf[tdf$avg==max(tdf$avg),] 
# store the value in a variable to insert into the text below
max_interval <- tdf[tdf$avg==max(tdf$avg),]$interval 
```

The interval that contains the maximum number of steps on average is `r max_interval`.

## Imputing missing values

Calculate the total number of missing values in the dataset:
```{r}
sum(is.na(df$steps))
```
Look at the times at which these NA values occur. Missing values during the night should be set to 0.



## Are there differences in activity patterns between weekdays and weekends?
